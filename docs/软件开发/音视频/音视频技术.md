# 视频播放器原理

> [视音频编解码技术零基础学习方法](http://blog.csdn.net/leixiaohua1020/article/details/18893769#t2)

## 网络视频

1. 解协议
2. 解封装
3. 解码视音频
4. 视音频同步

## 本地视频

不需要解协议

1. 解封装
2. 解码视音频
3. 视音频同步

![1](http://img.blog.csdn.net/20140201120523046?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvbGVpeGlhb2h1YTEwMjA=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/SouthEast)

## 解协议

将流媒体协议的数据，解析为标准的相应的封装格式数据。

视音频在网上传播的时候，常常采用各种流媒体协议，如HTTP，RTMP或MMS等。这些协议在传输视音频数据的同事也会传递一些信令数据。这些信令数据包含对视频的控制（播放、暂停、停止）或者对网络状态的描述。解协议的过程中会去掉信令数据只保留视音频数据。

## 解封装

将输入的封装格式的数据，分离成音频压缩编码数据和视频流压缩编码数据。

封装格式种类很多（MP4、RMVB、FLV等）。封装格式的作用就是将已经压缩编码的视频数据和音频数据按照一定的格式放到一起。

解封装就是将封装格式的数据分离开。

## 解码

解码的作用就是将视频/音频压缩编码数据，解码成为非压缩的视频/音频原始数据。

音频的压缩编码标准包含 AAC，MP3，AC-3 等等，视频的压缩编码标准则包含 H.264，MPEG2，VC-1 等等。

解码是整个系统中最重要也是最复杂的一个环节。

通过解码，压缩编码的视频数据输出成为非压缩的颜色数据，例如 YUV420P，RGB 等等；压缩编码的音频数据输出成为非压缩的音频抽样数据，例如 PCM 数据。

## 视音频同步

根据解封装模块处理过程中获取到的参数信息，同步解码出来的视频和音频数据，并将视频音频数据送至系统的显卡和声卡播放出来。

# 主要媒体协议

| 名称       | 推出机构           | 传输层协议   | 客户端      | 目前使用领域     |
| -------- | -------------- | ------- | -------- | ---------- |
| RTSP+RTP | IETF           | TCP+UDP | VLC, WMP | IPTV       |
| RTMP     | Adobe Inc.     | TCP     | Flash    | 互联网直播      |
| RTMFP    | Adobe Inc.     | UDP     | Flash    | 互联网直播      |
| MMS      | Microsoft Inc. | TCP/UDP | WMP      | 互联网直播 + 点播 |
| HTTP     | WWW+IETF       | TCP     | Flash    | 互联网点播      |

# 封装格式

封装格式的主要作用是把视频码流和音频码流按照一定的格式存储在一个文件中。

| 名称   | 推出机构               | 流媒体  | 支持的视频编码                        | 支持的音频编码                               | 目前使用领域    |
| ---- | ------------------ | ---- | ------------------------------ | ------------------------------------- | --------- |
| AVI  | Microsoft Inc.     | 不支持  | 几乎所有格式                         | 几乎所有格式                                | BT 下载影视   |
| MP4  | MPEG               | 支持   | MPEG-2, MPEG-4, H.264, H.263 等 | AAC, MPEG-1 Layers I, II, III, AC-3 等 | 互联网视频网站   |
| TS   | MPEG               | 支持   | MPEG-1, MPEG-2, MPEG-4, H.264  | MPEG-1 Layers I, II, III, AAC,        | IPTV，数字电视 |
| FLV  | Adobe Inc.         | 支持   | Sorenson, VP6, H.264           | MP3, ADPCM, Linear PCM, AAC 等         | 互联网视频网站   |
| MKV  | CoreCodec Inc.     | 支持   | 几乎所有格式                         | 几乎所有格式                                | 互联网视频网站   |
| RMVB | Real Networks Inc. | 支持   | RealVideo 8, 9, 10             | AAC, Cook Codec, RealAudio Lossless   | BT 下载影视   |

# 视频编码

视频编码的主要作用是将视频像素数据（RGB，YUV等）压缩成为视频码流，从而降低视频的数据量。

视频编码是视音频技术中最重要的技术之一。视频码流的数据量占了视音频总数据量的绝大部分。高效率的视频编码在同等的码率下，可以获得更高的视频质量。

主要视频编码一览

| 名称          | 推出机构           | 推出时间 | 目前使用领域 |
| ----------- | -------------- | ---- | ------ |
| HEVC(H.265) | MPEG/ITU-T     | 2013 | 研发中    |
| H.264       | MPEG/ITU-T     | 2003 | 各个领域   |
| MPEG4       | MPEG           | 2001 | 不温不火   |
| MPEG2       | MPEG           | 1994 | 数字电视   |
| VP9         | Google         | 2013 | 研发中    |
| VP8         | Google         | 2008 | 不普及    |
| VC-1        | Microsoft Inc. | 2006 | 微软平台   |

# 音频编码

音频编码的主要作用是将视频采样数据（PCM等）压缩成为音频码流，从而降低视频的数据量。高效率的音频编码在同等码率下，可以获得更高的音质。

主要音频编码

| 名称   | 推出机构           | 推出时间 | 目前使用领域  |
| ---- | -------------- | ---- | ------- |
| AAC  | MPEG           | 1997 | 各个领域（新） |
| AC-3 | Dolby Inc.     | 1992 | 电影      |
| MP3  | MPEG           | 1993 | 各个领域（旧） |
| WMA  | Microsoft Inc. | 1999 | 微软平台    |

